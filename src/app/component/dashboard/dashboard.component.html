<!-- Reusable fixed navbar -->
<app-navbar></app-navbar>

<!-- Page surface (add top padding to clear the fixed navbar) -->
<div class="relative min-h-screen w-full overflow-x-hidden pt-16 sm:pt-16 bg-gradient-to-br from-slate-50 via-indigo-50 to-cyan-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950">

  <!-- soft blobs -->
  <div class="pointer-events-none absolute -top-20 -left-24 h-72 w-72 rounded-full bg-gradient-to-tr from-indigo-500 to-cyan-400 opacity-20 blur-3xl"></div>
  <div class="pointer-events-none absolute -bottom-24 -right-24 h-96 w-96 rounded-full bg-gradient-to-tr from-fuchsia-500 to-indigo-500 opacity-20 blur-3xl"></div>

  <!-- Layout -->
  <div class="mx-auto grid max-w-7xl grid-cols-1 lg:grid-cols-[240px_minmax(0,1fr)]">

    <!-- Sidebar (desktop) -->
    <aside class="hidden lg:block lg:min-h-[calc(100vh-64px)] bg-white/70 dark:bg-slate-900/60 backdrop-blur ring-1 ring-black/5">
      <nav class="p-4 space-y-1">
        <div class="px-2 py-1 text-[11px] uppercase tracking-wide text-slate-500 dark:text-slate-400">Navigation</div>
        <a routerLink="/dashboard" [routerLinkActiveOptions]="{exact:true}" routerLinkActive="bg-slate-100 dark:bg-slate-800"
           class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Accueil</a>
        <a routerLink="/modules" class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Modules</a>
        <a routerLink="/messages" class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Messages</a>
        <a routerLink="/calendar" class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Calendrier</a>

        <div class="mt-6 px-2 py-1 text-[11px] uppercase tracking-wide text-slate-500 dark:text-slate-400">Compte</div>
        <div class="rounded-xl bg-slate-50 p-3 ring-1 ring-slate-200 dark:bg-slate-800/60 dark:ring-slate-700">
          <ng-container *ngIf="me$ | async as me; else sideChipLoading">
            <div class="flex items-center gap-3">
              <div class="grid h-8 w-8 place-items-center rounded-full bg-indigo-600 text-[11px] font-bold text-white shadow">{{ initials(me) }}</div>
              <div class="text-sm break-all">{{ label(me) }}</div>
            </div>
          </ng-container>
          <ng-template #sideChipLoading>
            <div class="h-8 w-full rounded bg-slate-200 dark:bg-slate-700 animate-pulse"></div>
          </ng-template>
        </div>
      </nav>
    </aside>

    <!-- Main -->
    <main class="min-h-screen">
      <!-- Welcome -->
      <section class="px-4 pt-6">
        <div class="rounded-3xl bg-white/80 dark:bg-slate-900/70 backdrop-blur ring-1 ring-black/5 shadow-md p-5 md:p-6">
          <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
            <div class="flex items-center gap-4">
              <div class="relative">
                <img src="assets/img/fondation-gervais-logo.jpeg" class="md:h-12 md:w-12 h-8 w-8 rounded-2xl ring-2 ring-indigo-300/60" alt="">
                <span class="absolute -right-1 -bottom-1 h-3 w-3 rounded-full bg-emerald-500 ring-2 ring-white dark:ring-slate-900"></span>
              </div>
              <div>
                <h1 class="text-xl md:text-2xl font-bold text-slate-900 dark:text-white">
                  <ng-container *ngIf="me$ | async as me; else friendlyLoading">
                    Bonjour,
                    <span class="bg-gradient-to-r from-indigo-600 to-cyan-600 bg-clip-text text-transparent">
                      {{ friendlyName(me) }}
                    </span>
                  </ng-container>
                  <ng-template #friendlyLoading>
                    Bonjour, <span class="text-slate-400">…</span>
                  </ng-template>
                </h1>
                <p class="text-sm text-slate-600 dark:text-slate-300">Bienvenue sur l’espace de formation — Fondation Gervais ABC.</p>
              </div>
            </div>

            <div class="flex gap-2">
              <a routerLink="/modules" class="rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-700">Reprendre</a>
              <a routerLink="/calendar" class="rounded-xl px-4 py-2 text-sm font-semibold text-slate-700 ring-1 ring-slate-200 hover:bg-white/70 dark:text-slate-200 dark:ring-slate-700 dark:hover:bg-slate-800/60">Calendrier</a>
            </div>
          </div>
        </div>
      </section>

      <!-- Stats -->
      <section class="px-4 pt-6 grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4">
        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-indigo-100 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M4 3h16v2H4zm0 4h16v14H4zM7 9h3v3H7z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Modules terminés</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>

        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-cyan-100 text-cyan-700 dark:bg-cyan-900/40 dark:text-cyan-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Temps d’apprentissage</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>

        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="m10 17-4-4 1.4-1.4L10 14.2l6.6-6.6L18 9z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Score moyen</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>

        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-fuchsia-100 text-fuchsia-700 dark:bg-fuchsia-900/40 dark:text-fuchsia-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M7 2h2v2h6V2h2v2h3v18H4V4h3V2zm13 8H4v10h16V10z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Prochaine session</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Main content -->
      <section class="px-4 py-6 grid grid-cols-1 gap-6 xl:grid-cols-3">
        <!-- Continue / Announcements -->
        <div class="xl:col-span-2 space-y-6">
          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <div class="mb-3 flex items-center justify-between">
              <h2 class="text-lg font-semibold">Reprendre l’apprentissage</h2>
              <a routerLink="/modules" class="text-sm text-indigo-600 hover:underline dark:text-indigo-400">Voir tout</a>
            </div>
            <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
              <div class="group rounded-2xl border border-slate-200/80 p-4 hover:shadow-lg transition dark:border-slate-800">
                <div class="flex items-center gap-3">
                  <span class="grid h-10 w-10 place-items-center rounded-xl bg-indigo-50 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300">
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M21 4H7a2 2 0 0 0-2 2v12l4-2 4 2 4-2 4 2V6a2 2 0 0 0-2-2z"/></svg>
                  </span>
                  <div>
                    <div class="font-medium">Bases du prêt</div>
                    <div class="text-xs text-slate-500">Progression —</div>
                  </div>
                </div>
              </div>

              <div class="group rounded-2xl border border-slate-200/80 p-4 hover:shadow-lg transition dark:border-slate-800">
                <div class="flex items-center gap-3">
                  <span class="grid h-10 w-10 place-items-center rounded-xl bg-cyan-50 text-cyan-700 dark:bg-cyan-900/40 dark:text-cyan-300">
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8z"/></svg>
                  </span>
                  <div>
                    <div class="font-medium">Credit scoring</div>
                    <div class="text-xs text-slate-500">Progression —</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <h2 class="text-lg font-semibold mb-2">Annonces</h2>
            <div class="h-36 grid place-items-center rounded-xl bg-slate-100 text-slate-400 dark:bg-slate-800">Contenu à venir</div>
          </div>
        </div>

        <!-- Right rail -->
        <aside class="space-y-6">
          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <h3 class="font-semibold mb-2">Raccourcis</h3>
            <ul class="space-y-2 text-sm">
              <li><a routerLink="/messages" class="text-indigo-600 hover:underline dark:text-indigo-400">Messages</a></li>
              <li><a routerLink="/calendar" class="text-indigo-600 hover:underline dark:text-indigo-400">Calendrier</a></li>
              <li><a routerLink="/results" class="text-indigo-600 hover:underline dark:text-indigo-400">Résultats</a></li>
            </ul>
          </div>

          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <h3 class="font-semibold mb-2">Support & ressources</h3>
            <p class="text-sm text-slate-700 dark:text-slate-300">
              <span class="font-medium">Assistance :</span> support@fondation-gervais.org — +1 (000) 000-0000<br>
              <span class="font-medium">Procédures :</span> KYC, conformité, anti-fraude (placeholders).
            </p>
          </div>
        </aside>
      </section>
    </main>
  </div>
</div>
