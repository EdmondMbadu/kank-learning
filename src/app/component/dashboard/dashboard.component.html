<!-- Ambient surface -->
<div class="relative min-h-screen w-full overflow-x-hidden bg-gradient-to-br from-slate-50 via-indigo-50 to-cyan-50 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950">

  <!-- soft blobs -->
  <div class="pointer-events-none absolute -top-20 -left-24 h-72 w-72 rounded-full bg-gradient-to-tr from-indigo-500 to-cyan-400 opacity-20 blur-3xl"></div>
  <div class="pointer-events-none absolute -bottom-24 -right-24 h-96 w-96 rounded-full bg-gradient-to-tr from-fuchsia-500 to-indigo-500 opacity-20 blur-3xl"></div>

  <!-- Top bar -->
  <header class="sticky top-0 z-40 bg-white/80 dark:bg-slate-900/70 backdrop-blur ring-1 ring-black/5">
    <div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-3">
      <div class="flex items-center gap-3">
        <button class="lg:hidden rounded-md p-2 hover:bg-slate-100 dark:hover:bg-slate-800"
                (click)="toggleMobileMenu()" aria-label="Ouvrir le menu">
          <svg class="h-6 w-6 text-slate-700 dark:text-slate-200" viewBox="0 0 24 24" fill="currentColor"><path d="M3 6h18v2H3M3 11h18v2H3m0 5h18v2H3"/></svg>
        </button>

        <img src="assets/img/fondation-gervais-logo.jpeg" alt=""
             class="md:h-9 md:w-9 h-5 w-5 rounded-full object-cover ring-2 ring-indigo-300/60 shadow-sm">
        <span class="text-lg font-bold text-slate-900 dark:text-white tracking-tight">
          Fondation Gervais <span class="text-indigo-600 dark:text-indigo-400">ABC</span>
        </span>

        <!-- Desktop nav -->
        <nav class="ml-6 hidden lg:flex gap-1">
          <a routerLink="/dashboard" [routerLinkActiveOptions]="{exact:true}" routerLinkActive="bg-slate-900 text-white dark:bg-white dark:text-slate-900"
             class="rounded-xl px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800">Accueil</a>
          <a routerLink="/modules" class="rounded-xl px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800">Modules</a>
          <a routerLink="/messages" class="rounded-xl px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800">Messages</a>
          <a routerLink="/calendar" class="rounded-xl px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800">Calendrier</a>
        </nav>
      </div>

      <!-- account chip -->
      <div class="flex items-center gap-3">
        <div class="hidden md:flex items-center gap-2 rounded-2xl bg-white/80 px-2.5 py-1 ring-1 ring-slate-200 shadow-sm dark:bg-slate-800/70 dark:ring-slate-700">
          <div class="grid h-7 w-7 place-items-center rounded-full bg-gradient-to-tr from-indigo-600 to-cyan-600 text-[11px] font-bold text-white shadow">
            {{ initials(currentUserLabel) }}
          </div>
          <div class="leading-tight">
            <div class="text-xs text-slate-500 dark:text-slate-400">Connecté en tant que</div>
            <div class="text-sm font-medium text-slate-800 dark:text-slate-100">{{ currentUserLabel }}</div>
          </div>
        </div>
        <button (click)="logout()"
                class="hidden sm:inline rounded-xl px-3 py-1.5 text-sm font-semibold text-slate-700 ring-1 ring-slate-200 hover:bg-slate-100 dark:text-slate-200 dark:ring-slate-700 dark:hover:bg-slate-800">
          Déconnexion
        </button>
      </div>
    </div>
  </header>

  <!-- Mobile drawer -->
  <div *ngIf="mobileOpen" class="lg:hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/40" (click)="closeMobile()"></div>
    <aside class="absolute left-0 top-0 h-full w-72 bg-slate-900 text-slate-200 shadow-2xl">
      <div class="flex items-center gap-3 px-4 py-4 border-b border-white/10">
        <img src="assets/img/fondation-gervais-logo.jpeg" class="md:h-9 md:w-9 h-5 w-5 rounded-full ring-2 ring-indigo-300/50" alt="">
        <div class="text-sm">
          <div class="font-semibold">Fondation Gervais ABC</div>
          <div class="text-slate-400">Espace interne</div>
        </div>
        <button class="ml-auto rounded p-1 hover:bg-white/10" (click)="closeMobile()">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.4 17.6 5 12 10.6 6.4 5 5 6.4 10.6 12 5 17.6 6.4 19 12 13.4 17.6 19 19 17.6 13.4 12 19 6.4z"/></svg>
        </button>
      </div>
      <div class="px-4 py-3">
        <div class="flex items-center gap-2 rounded-xl bg-white/10 px-2.5 py-1">
          <div class="grid h-6 w-6 place-items-center rounded-full bg-indigo-500 text-[11px] font-bold text-white">
            {{ initials(currentUserLabel) }}
          </div>
          <div class="text-sm">{{ currentUserLabel }}</div>
        </div>
      </div>
      <nav class="px-2 py-2 space-y-1">
        <a routerLink="/dashboard" [routerLinkActiveOptions]="{exact:true}" routerLinkActive="bg-white/10"
           class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-white/10">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 11h8V3H3zm0 10h8v-8H3zm10 0h8v-6h-8zm0-12h8V3h-8z"/></svg>
          Accueil
        </a>
        <a routerLink="/modules" class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-white/10">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M4 3h12a2 2 0 012 2v14l-6-3-6 3V5a2 2 0 012-2z"/></svg>
          Modules
        </a>
        <a routerLink="/messages" class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-white/10">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4a2 2 0 00-2 2v14l4-4h14a2 2 0 002-2V4a2 2 0 00-2-2z"/></svg>
          Messages
        </a>
        <a routerLink="/calendar" class="flex items-center gap-3 rounded-lg px-3 py-2 hover:bg-white/10">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M7 2h2v2h6V2h2v2h3v18H4V4h3V2zm13 8H4v10h16V10z"/></svg>
          Calendrier
        </a>
        <button (click)="logout()" class="mt-2 w-full text-left rounded-lg px-3 py-2 hover:bg-white/10">
          <svg class="mr-2 inline h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M10 17v-2h4v-6h-4V7l-5 5 5 5zm9-12h-8v2h8v10h-8v2h8a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z"/></svg>
          Déconnexion
        </button>
      </nav>
    </aside>
  </div>

  <!-- Layout -->
  <div class="mx-auto grid max-w-7xl grid-cols-1 lg:grid-cols-[240px_minmax(0,1fr)]">

    <!-- Sidebar (desktop) -->
    <aside class="hidden lg:block lg:min-h-[calc(100vh-64px)] bg-white/70 dark:bg-slate-900/60 backdrop-blur ring-1 ring-black/5">
      <nav class="p-4 space-y-1">
        <div class="px-2 py-1 text-[11px] uppercase tracking-wide text-slate-500 dark:text-slate-400">Navigation</div>
        <a routerLink="/dashboard" [routerLinkActiveOptions]="{exact:true}" routerLinkActive="bg-slate-100 dark:bg-slate-800"
           class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Accueil</a>
        <a routerLink="/modules" class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Modules</a>
        <a routerLink="/messages" class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Messages</a>
        <a routerLink="/calendar" class="block rounded-xl px-3 py-2 text-sm hover:bg-slate-100 dark:hover:bg-slate-800">Calendrier</a>

        <div class="mt-6 px-2 py-1 text-[11px] uppercase tracking-wide text-slate-500 dark:text-slate-400">Compte</div>
        <div class="rounded-xl bg-slate-50 p-3 ring-1 ring-slate-200 dark:bg-slate-800/60 dark:ring-slate-700">
          <div class="flex items-center gap-3">
            <div class="grid h-8 w-8 place-items-center rounded-full bg-indigo-600 text-[11px] font-bold text-white shadow">{{ initials(currentUserLabel) }}</div>
            <div class="text-sm break-all">{{ currentUserLabel }}</div>
          </div>
        </div>
      </nav>
    </aside>

    <!-- Main -->
    <main class="min-h-screen">
      <!-- Welcome -->
      <section class="px-4 pt-6">
        <div class="rounded-3xl bg-white/80 dark:bg-slate-900/70 backdrop-blur ring-1 ring-black/5 shadow-md p-5 md:p-6">
          <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
            <div class="flex items-center gap-4">
              <div class="relative">
                <img src="assets/img/fondation-gervais-logo.jpeg" class="md:h-12 md:w-12 h-8 w-8 rounded-2xl ring-2 ring-indigo-300/60" alt="">
                <span class="absolute -right-1 -bottom-1 h-3 w-3 rounded-full bg-emerald-500 ring-2 ring-white dark:ring-slate-900"></span>
              </div>
              <div>
                <h1 class="text-xl md:text-2xl font-bold text-slate-900 dark:text-white">
                  Bonjour, <span class="bg-gradient-to-r from-indigo-600 to-cyan-600 bg-clip-text text-transparent">{{ friendlyName(currentUserLabel) }}</span>
                </h1>
                <p class="text-sm text-slate-600 dark:text-slate-300">Bienvenue sur l’espace de formation — Fondation Gervais ABC.</p>
              </div>
            </div>

            <div class="flex gap-2">
              <a routerLink="/modules" class="rounded-xl bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-indigo-700">Reprendre</a>
              <a routerLink="/calendar" class="rounded-xl px-4 py-2 text-sm font-semibold text-slate-700 ring-1 ring-slate-200 hover:bg-white/70 dark:text-slate-200 dark:ring-slate-700 dark:hover:bg-slate-800/60">Calendrier</a>
            </div>
          </div>
        </div>
      </section>

      <!-- Stats -->
      <section class="px-4 pt-6 grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-4">
        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-indigo-100 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M4 3h16v2H4zm0 4h16v14H4zM7 9h3v3H7z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Modules terminés</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>

        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-cyan-100 text-cyan-700 dark:bg-cyan-900/40 dark:text-cyan-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Temps d’apprentissage</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>

        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="m10 17-4-4 1.4-1.4L10 14.2l6.6-6.6L18 9z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Score moyen</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>

        <div class="group rounded-2xl bg-white/80 p-5 ring-1 ring-black/5 shadow hover:shadow-lg transition dark:bg-slate-900/70">
          <div class="flex items-center gap-3">
            <span class="grid h-10 w-10 place-items-center rounded-xl bg-fuchsia-100 text-fuchsia-700 dark:bg-fuchsia-900/40 dark:text-fuchsia-300">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M7 2h2v2h6V2h2v2h3v18H4V4h3V2zm13 8H4v10h16V10z"/></svg>
            </span>
            <div class="ml-auto text-right">
              <div class="text-xs text-slate-500">Prochaine session</div>
              <div class="text-xl font-bold">—</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Main content -->
      <section class="px-4 py-6 grid grid-cols-1 gap-6 xl:grid-cols-3">
        <!-- Continue / Announcements -->
        <div class="xl:col-span-2 space-y-6">
          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <div class="mb-3 flex items-center justify-between">
              <h2 class="text-lg font-semibold">Reprendre l’apprentissage</h2>
              <a routerLink="/modules" class="text-sm text-indigo-600 hover:underline dark:text-indigo-400">Voir tout</a>
            </div>
            <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
              <div class="group rounded-2xl border border-slate-200/80 p-4 hover:shadow-lg transition dark:border-slate-800">
                <div class="flex items-center gap-3">
                  <span class="grid h-10 w-10 place-items-center rounded-xl bg-indigo-50 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300">
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M21 4H7a2 2 0 0 0-2 2v12l4-2 4 2 4-2 4 2V6a2 2 0 0 0-2-2z"/></svg>
                  </span>
                  <div>
                    <div class="font-medium">Bases du prêt</div>
                    <div class="text-xs text-slate-500">Progression —</div>
                  </div>
                </div>
              </div>

              <div class="group rounded-2xl border border-slate-200/80 p-4 hover:shadow-lg transition dark:border-slate-800">
                <div class="flex items-center gap-3">
                  <span class="grid h-10 w-10 place-items-center rounded-xl bg-cyan-50 text-cyan-700 dark:bg-cyan-900/40 dark:text-cyan-300">
                    <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8z"/></svg>
                  </span>
                  <div>
                    <div class="font-medium">Credit scoring</div>
                    <div class="text-xs text-slate-500">Progression —</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <h2 class="text-lg font-semibold mb-2">Annonces</h2>
            <div class="h-36 grid place-items-center rounded-xl bg-slate-100 text-slate-400 dark:bg-slate-800">Contenu à venir</div>
          </div>
        </div>

        <!-- Right rail -->
        <aside class="space-y-6">
          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <h3 class="font-semibold mb-2">Raccourcis</h3>
            <ul class="space-y-2 text-sm">
              <li><a routerLink="/messages" class="text-indigo-600 hover:underline dark:text-indigo-400">Messages</a></li>
              <li><a routerLink="/calendar" class="text-indigo-600 hover:underline dark:text-indigo-400">Calendrier</a></li>
              <li><a routerLink="/results" class="text-indigo-600 hover:underline dark:text-indigo-400">Résultats</a></li>
            </ul>
          </div>

          <div class="rounded-3xl bg-white/85 p-5 ring-1 ring-black/5 shadow-md dark:bg-slate-900/70">
            <h3 class="font-semibold mb-2">Support & ressources</h3>
            <p class="text-sm text-slate-700 dark:text-slate-300">
              <span class="font-medium">Assistance :</span> support@fondation-gervais.org — +1 (000) 000-0000<br>
              <span class="font-medium">Procédures :</span> KYC, conformité, anti-fraude (placeholders).
            </p>
          </div>
        </aside>
      </section>
    </main>
  </div>
</div>
